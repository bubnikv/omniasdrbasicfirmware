C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE USBFS_HID
OBJECT MODULE PLACED IN .\DP8051\DP8051_Keil_951\Debug\USBFS_hid.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\3.3\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -.\Generated_Source\PSoC3\USBFS_hid.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB DF(DEBU
                    -G) WL(2) PR(.\DP8051\DP8051_Keil_951\Debug/USBFS_hid.lst) CD OT(2,SIZE) OJ(.\DP8051\DP8051_Keil_951\Debug\USBFS_hid.obj)

line level    source

   1          /*******************************************************************************
   2          * File Name: USBFS_hid.c
   3          * Version 2.80
   4          *
   5          * Description:
   6          *  USB HID Class request handler.
   7          *
   8          * Related Document:
   9          *  Device Class Definition for Human Interface Devices (HID) Version 1.11
  10          *
  11          * Note:
  12          *
  13          ********************************************************************************
  14          * Copyright 2008-2014, Cypress Semiconductor Corporation.  All rights reserved.
  15          * You may use this file only in accordance with the license, terms, conditions,
  16          * disclaimers, and limitations in the end user license agreement accompanying
  17          * the software package with which this file was provided.
  18          *******************************************************************************/
  19          
  20          #include "USBFS.h"
  21          
  22          #if defined(USBFS_ENABLE_HID_CLASS)
  23          
  24          #include "USBFS_pvt.h"
  25          #include "USBFS_hid.h"
  26          
  27          
  28          
  29          /***************************************
  30          *    HID Variables
  31          ***************************************/
  32          
  33          volatile uint8 USBFS_hidProtocol[USBFS_MAX_INTERFACES_NUMBER];  /* HID device protocol status */
  34          volatile uint8 USBFS_hidIdleRate[USBFS_MAX_INTERFACES_NUMBER];  /* HID device idle reload value */
  35          volatile uint8 USBFS_hidIdleTimer[USBFS_MAX_INTERFACES_NUMBER]; /* HID device idle rate value */
  36          
  37          
  38          /***************************************
  39          * Custom Declarations
  40          ***************************************/
  41          
  42          /* `#START HID_CUSTOM_DECLARATIONS` Place your declaration here */
  43          
  44          /* `#END` */
  45          
  46          
  47          /*******************************************************************************
  48          * Function Name: USBFS_UpdateHIDTimer
  49          ********************************************************************************
  50          *
  51          * Summary:
  52          *  Updates the HID report timer and reloads it if expired
  53          *
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 2   

  54          * Parameters:
  55          *  interface:  Interface Number.
  56          *
  57          * Return:
  58          *  status.
  59          *
  60          * Reentrant:
  61          *  No.
  62          *
  63          *******************************************************************************/
  64          uint8 USBFS_UpdateHIDTimer(uint8 interface) 
  65          {
  66   1          uint8 stat = USBFS_IDLE_TIMER_INDEFINITE;
  67   1      
  68   1          if(USBFS_hidIdleRate[interface] != 0u)
  69   1          {
  70   2              if(USBFS_hidIdleTimer[interface] > 0u)
  71   2              {
  72   3                  USBFS_hidIdleTimer[interface]--;
  73   3                  stat = USBFS_IDLE_TIMER_RUNNING;
  74   3              }
  75   2              else
  76   2              {
  77   3                  USBFS_hidIdleTimer[interface] = USBFS_hidIdleRate[interface];
  78   3                  stat = USBFS_IDLE_TIMER_EXPIRED;
  79   3              }
  80   2          }
  81   1      
  82   1          return(stat);
  83   1      }
  84          
  85          
  86          /*******************************************************************************
  87          * Function Name: USBFS_GetProtocol
  88          ********************************************************************************
  89          *
  90          * Summary:
  91          *  Returns the selected protocol value to the application
  92          *
  93          * Parameters:
  94          *  interface:  Interface Number.
  95          *
  96          * Return:
  97          *  Interface protocol.
  98          *
  99          *******************************************************************************/
 100          uint8 USBFS_GetProtocol(uint8 interface) 
 101          {
 102   1          return(USBFS_hidProtocol[interface]);
 103   1      }
 104          
 105          
 106          /*******************************************************************************
 107          * Function Name: USBFS_DispatchHIDClassRqst
 108          ********************************************************************************
 109          *
 110          * Summary:
 111          *  This routine dispatches class requests
 112          *
 113          * Parameters:
 114          *  None.
 115          *
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 3   

 116          * Return:
 117          *  requestHandled
 118          *
 119          * Reentrant:
 120          *  No.
 121          *
 122          *******************************************************************************/
 123          uint8 USBFS_DispatchHIDClassRqst(void) 
 124          {
 125   1          uint8 requestHandled = USBFS_FALSE;
 126   1          uint8 interfaceNumber;
 127   1      
 128   1          interfaceNumber = CY_GET_REG8(USBFS_wIndexLo);
 129   1          if ((CY_GET_REG8(USBFS_bmRequestType) & USBFS_RQST_DIR_MASK) == USBFS_RQST_DIR_D2H)
 130   1          {   /* Control Read */
 131   2              switch (CY_GET_REG8(USBFS_bRequest))
 132   2              {
 133   3                  case USBFS_GET_DESCRIPTOR:
 134   3                      if (CY_GET_REG8(USBFS_wValueHi) == USBFS_DESCR_HID_CLASS)
 135   3                      {
 136   4                          USBFS_FindHidClassDecriptor();
 137   4                          if (USBFS_currentTD.count != 0u)
 138   4                          {
 139   5                              requestHandled = USBFS_InitControlRead();
 140   5                          }
 141   4                      }
 142   3                      else if (CY_GET_REG8(USBFS_wValueHi) == USBFS_DESCR_HID_REPORT)
 143   3                      {
 144   4                          USBFS_FindReportDescriptor();
 145   4                          if (USBFS_currentTD.count != 0u)
 146   4                          {
 147   5                              requestHandled = USBFS_InitControlRead();
 148   5                          }
 149   4                      }
 150   3                      else
 151   3                      {   /* requestHandled is initialezed as FALSE by default */
 152   4                      }
 153   3                      break;
 154   3                  case USBFS_HID_GET_REPORT:
 155   3                      USBFS_FindReport();
 156   3                      if (USBFS_currentTD.count != 0u)
 157   3                      {
 158   4                          requestHandled = USBFS_InitControlRead();
 159   4                      }
 160   3                      break;
 161   3      
 162   3                  case USBFS_HID_GET_IDLE:
 163   3                      /* This function does not support multiple reports per interface*/
 164   3                      /* Validate interfaceNumber and Report ID (should be 0) */
 165   3                      if( (interfaceNumber < USBFS_MAX_INTERFACES_NUMBER) &&
 166   3                          (CY_GET_REG8(USBFS_wValueLo) == 0u ) ) /* Do not support Idle per Report ID */
 167   3                      {
 168   4                          USBFS_currentTD.count = 1u;
 169   4                          USBFS_currentTD.pData = &USBFS_hidIdleRate[interfaceNumber];
 170   4                          requestHandled  = USBFS_InitControlRead();
 171   4                      }
 172   3                      break;
 173   3                  case USBFS_HID_GET_PROTOCOL:
 174   3                      /* Validate interfaceNumber */
 175   3                      if( interfaceNumber < USBFS_MAX_INTERFACES_NUMBER)
 176   3                      {
 177   4                          USBFS_currentTD.count = 1u;
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 4   

 178   4                          USBFS_currentTD.pData = &USBFS_hidProtocol[interfaceNumber];
 179   4                          requestHandled  = USBFS_InitControlRead();
 180   4                      }
 181   3                      break;
 182   3                  default:    /* requestHandled is initialized as FALSE by default */
 183   3                      break;
 184   3              }
 185   2          }
 186   1          else if ((CY_GET_REG8(USBFS_bmRequestType) & USBFS_RQST_DIR_MASK) ==
 187   1                                                                                  USBFS_RQST_DIR_H2D)
 188   1          {   /* Control Write */
 189   2              switch (CY_GET_REG8(USBFS_bRequest))
 190   2              {
 191   3                  case USBFS_HID_SET_REPORT:
 192   3                      USBFS_FindReport();
 193   3                      if (USBFS_currentTD.count != 0u)
 194   3                      {
 195   4                          requestHandled = USBFS_InitControlWrite();
 196   4                      }
 197   3                      break;
 198   3                  case USBFS_HID_SET_IDLE:
 199   3                      /* This function does not support multiple reports per interface */
 200   3                      /* Validate interfaceNumber and Report ID (should be 0) */
 201   3                      if( (interfaceNumber < USBFS_MAX_INTERFACES_NUMBER) &&
 202   3                          (CY_GET_REG8(USBFS_wValueLo) == 0u ) ) /* Do not support Idle per Report ID */
 203   3                      {
 204   4                          USBFS_hidIdleRate[interfaceNumber] = CY_GET_REG8(USBFS_wValueHi);
 205   4                          /* With regards to HID spec: "7.2.4 Set_Idle Request"
 206   4                          *  Latency. If the current period has gone past the
 207   4                          *  newly proscribed time duration, then a report
 208   4                          *  will be generated immediately.
 209   4                          */
 210   4                          if(USBFS_hidIdleRate[interfaceNumber] <
 211   4                             USBFS_hidIdleTimer[interfaceNumber])
 212   4                          {
 213   5                              /* Set the timer to zero and let the UpdateHIDTimer() API return IDLE_TIMER_EXPIRE
             -D status*/
 214   5                              USBFS_hidIdleTimer[interfaceNumber] = 0u;
 215   5                          }
 216   4                          /* If the new request is received within 4 milliseconds
 217   4                          *  (1 count) of the end of the current period, then the
 218   4                          *  new request will have no effect until after the report.
 219   4                          */
 220   4                          else if(USBFS_hidIdleTimer[interfaceNumber] <= 1u)
 221   4                          {
 222   5                              /* Do nothing.
 223   5                              *  Let the UpdateHIDTimer() API continue to work and
 224   5                              *  return IDLE_TIMER_EXPIRED status
 225   5                              */
 226   5                          }
 227   4                          else
 228   4                          {   /* Reload the timer*/
 229   5                              USBFS_hidIdleTimer[interfaceNumber] =
 230   5                              USBFS_hidIdleRate[interfaceNumber];
 231   5                          }
 232   4                          requestHandled = USBFS_InitNoDataControlTransfer();
 233   4                      }
 234   3                      break;
 235   3      
 236   3                  case USBFS_HID_SET_PROTOCOL:
 237   3                      /* Validate interfaceNumber and protocol (must be 0 or 1) */
 238   3                      if( (interfaceNumber < USBFS_MAX_INTERFACES_NUMBER) &&
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 5   

 239   3                          (CY_GET_REG8(USBFS_wValueLo) <= 1u) )
 240   3                      {
 241   4                          USBFS_hidProtocol[interfaceNumber] = CY_GET_REG8(USBFS_wValueLo);
 242   4                          requestHandled = USBFS_InitNoDataControlTransfer();
 243   4                      }
 244   3                      break;
 245   3                  default:    /* requestHandled is initialized as FALSE by default */
 246   3                      break;
 247   3              }
 248   2          }
 249   1          else
 250   1          {   /* requestHandled is initialized as FALSE by default */
 251   2          }
 252   1      
 253   1          return(requestHandled);
 254   1      }
 255          
 256          
 257          /*******************************************************************************
 258          * Function Name: USB_FindHidClassDescriptor
 259          ********************************************************************************
 260          *
 261          * Summary:
 262          *  This routine find Hid Class Descriptor pointer based on the Interface number
 263          *  and Alternate setting then loads the currentTD structure with the address of
 264          *  the buffer and the size.
 265          *  The HID Class Descriptor resides inside the config descriptor.
 266          *
 267          * Parameters:
 268          *  None.
 269          *
 270          * Return:
 271          *  currentTD
 272          *
 273          * Reentrant:
 274          *  No.
 275          *
 276          *******************************************************************************/
 277          void USBFS_FindHidClassDecriptor(void) 
 278          {
 279   1          const T_USBFS_LUT CYCODE *pTmp;
 280   1          volatile uint8 *pDescr;
 281   1          uint8 interfaceN;
 282   1      
 283   1          pTmp = USBFS_GetConfigTablePtr(USBFS_configuration - 1u);
 284   1          interfaceN = CY_GET_REG8(USBFS_wIndexLo);
 285   1          /* Third entry in the LUT starts the Interface Table pointers */
 286   1          /* Now use the request interface number*/
 287   1          pTmp = &pTmp[interfaceN + 2u];
 288   1          /* USB_DEVICEx_CONFIGURATIONy_INTERFACEz_TABLE */
 289   1          pTmp = (const T_USBFS_LUT CYCODE *) pTmp->p_list;
 290   1          /* Now use Alternate setting number */
 291   1          pTmp = &pTmp[USBFS_interfaceSetting[interfaceN]];
 292   1          /* USB_DEVICEx_CONFIGURATIONy_INTERFACEz_ALTERNATEi_HID_TABLE */
 293   1          pTmp = (const T_USBFS_LUT CYCODE *) pTmp->p_list;
 294   1          /* Fifth entry in the LUT points to Hid Class Descriptor in Configuration Descriptor */
 295   1          pTmp = &pTmp[4u];
 296   1          pDescr = (volatile uint8 *)pTmp->p_list;
 297   1          /* The first byte contains the descriptor length */
 298   1          USBFS_currentTD.count = *pDescr;
 299   1          USBFS_currentTD.pData = pDescr;
 300   1      }
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 6   

 301          
 302          
 303          /*******************************************************************************
 304          * Function Name: USB_FindReportDescriptor
 305          ********************************************************************************
 306          *
 307          * Summary:
 308          *  This routine find Hid Report Descriptor pointer based on the Interface
 309          *  number, then loads the currentTD structure with the address of the buffer
 310          *  and the size.
 311          *  Hid Report Descriptor is located after IN/OUT/FEATURE reports.
 312          *
 313          * Parameters:
 314          *   void
 315          *
 316          * Return:
 317          *  currentTD
 318          *
 319          * Reentrant:
 320          *  No.
 321          *
 322          *******************************************************************************/
 323          void USBFS_FindReportDescriptor(void) 
 324          {
 325   1          const T_USBFS_LUT CYCODE *pTmp;
 326   1          volatile uint8 *pDescr;
 327   1          uint8 interfaceN;
 328   1      
 329   1          pTmp = USBFS_GetConfigTablePtr(USBFS_configuration - 1u);
 330   1          interfaceN = CY_GET_REG8(USBFS_wIndexLo);
 331   1          /* Third entry in the LUT starts the Interface Table pointers */
 332   1          /* Now use the request interface number */
 333   1          pTmp = &pTmp[interfaceN + 2u];
 334   1          /* USB_DEVICEx_CONFIGURATIONy_INTERFACEz_TABLE */
 335   1          pTmp = (const T_USBFS_LUT CYCODE *) pTmp->p_list;
 336   1          /* Now use Alternate setting number */
 337   1          pTmp = &pTmp[USBFS_interfaceSetting[interfaceN]];
 338   1          /* USB_DEVICEx_CONFIGURATIONy_INTERFACEz_ALTERNATEi_HID_TABLE */
 339   1          pTmp = (const T_USBFS_LUT CYCODE *) pTmp->p_list;
 340   1          /* Fourth entry in the LUT starts the Hid Report Descriptor */
 341   1          pTmp = &pTmp[3u];
 342   1          pDescr = (volatile uint8 *)pTmp->p_list;
 343   1          /* The 1st and 2nd bytes of descriptor contain its length. LSB is 1st. */
 344   1          USBFS_currentTD.count =  (((uint16)pDescr[1u] << 8u) | pDescr[0u]);
 345   1          USBFS_currentTD.pData = &pDescr[2u];
 346   1      }
 347          
 348          
 349          /*******************************************************************************
 350          * Function Name: USBFS_FindReport
 351          ********************************************************************************
 352          *
 353          * Summary:
 354          *  This routine sets up a transfer based on the Interface number, Report Type
 355          *  and Report ID, then loads the currentTD structure with the address of the
 356          *  buffer and the size.  The caller has to decide if it is a control read or
 357          *  control write.
 358          *
 359          * Parameters:
 360          *  None.
 361          *
 362          * Return:
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 7   

 363          *  currentTD
 364          *
 365          * Reentrant:
 366          *  No.
 367          *
 368          *******************************************************************************/
 369          void USBFS_FindReport(void) 
 370          {
 371   1          const T_USBFS_LUT CYCODE *pTmp;
 372   1          T_USBFS_TD *pTD;
 373   1          uint8 interfaceN;
 374   1          uint8 reportType;
 375   1      
 376   1          /* `#START HID_FINDREPORT` Place custom handling here */
 377   1      
 378   1          /* `#END` */
 379   1          
 380   1          #ifdef USBFS_FIND_REPORT_CALLBACK
                      USBFS_FindReport_Callback();
                  #endif /* USBFS_FIND_REPORT_CALLBACK */
 383   1          
 384   1          USBFS_currentTD.count = 0u;   /* Init not supported condition */
 385   1          pTmp = USBFS_GetConfigTablePtr(USBFS_configuration - 1u);
 386   1          reportType = CY_GET_REG8(USBFS_wValueHi);
 387   1          interfaceN = CY_GET_REG8(USBFS_wIndexLo);
 388   1          /* Third entry in the LUT COnfiguration Table starts the Interface Table pointers */
 389   1          /* Now use the request interface number */
 390   1          pTmp = &pTmp[interfaceN + 2u];
 391   1          /* USB_DEVICEx_CONFIGURATIONy_INTERFACEz_TABLE*/
 392   1          pTmp = (const T_USBFS_LUT CYCODE *) pTmp->p_list;
 393   1          if(interfaceN < USBFS_MAX_INTERFACES_NUMBER)
 394   1          {
 395   2              /* Now use Alternate setting number */
 396   2              pTmp = &pTmp[USBFS_interfaceSetting[interfaceN]];
 397   2              /* USB_DEVICEx_CONFIGURATIONy_INTERFACEz_ALTERNATEi_HID_TABLE */
 398   2              pTmp = (const T_USBFS_LUT CYCODE *) pTmp->p_list;
 399   2              /* Validate reportType to comply with "7.2.1 Get_Report Request" */
 400   2              if((reportType >= USBFS_HID_GET_REPORT_INPUT) &&
 401   2                 (reportType <= USBFS_HID_GET_REPORT_FEATURE))
 402   2              {
 403   3                  /* Get the entry proper TD (IN, OUT or Feature Report Table)*/
 404   3                  pTmp = &pTmp[reportType - 1u];
 405   3                  reportType = CY_GET_REG8(USBFS_wValueLo);    /* Get reportID */
 406   3                  /* Validate table support by the HID descriptor, compare table count with reportID */
 407   3                  if(pTmp->c >= reportType)
 408   3                  {
 409   4                      pTD = (T_USBFS_TD *) pTmp->p_list;
 410   4                      pTD = &pTD[reportType];                          /* select entry depend on report ID*/
 411   4                      USBFS_currentTD.pData = pTD->pData;   /* Buffer pointer */
 412   4                      USBFS_currentTD.count = pTD->count;   /* Buffer Size */
 413   4                      USBFS_currentTD.pStatusBlock = pTD->pStatusBlock;
 414   4                  }
 415   3              }
 416   2          }
 417   1      }
 418          
 419          
 420          /*******************************************************************************
 421          * Additional user functions supporting HID Requests
 422          ********************************************************************************/
 423          
 424          /* `#START HID_FUNCTIONS` Place any additional functions here */
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 8   

 425          
 426          /* `#END` */
 427          
 428          #endif  /*  USBFS_ENABLE_HID_CLASS */
 429          
 430          
 431          /* [] END OF FILE */
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 9   

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION _USBFS_UpdateHIDTimer (BEGIN)
                                           ; SOURCE LINE # 64
0000 900000      R     MOV     DPTR,#interface
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 65
                                           ; SOURCE LINE # 66
0005 900000      R     MOV     DPTR,#stat
0008 E4                CLR     A
0009 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 68
000A 900000      R     MOV     DPTR,#interface
000D E0                MOVX    A,@DPTR
000E FF                MOV     R7,A
000F 7400        R     MOV     A,#LOW USBFS_hidIdleRate
0011 2F                ADD     A,R7
0012 F582              MOV     DPL,A
0014 E4                CLR     A
0015 3400        R     ADDC    A,#HIGH USBFS_hidIdleRate
0017 F583              MOV     DPH,A
0019 E0                MOVX    A,@DPTR
001A FF                MOV     R7,A
001B EF                MOV     A,R7
001C 6059              JZ      ?C0001
                                           ; SOURCE LINE # 69
                                           ; SOURCE LINE # 70
001E 900000      R     MOV     DPTR,#interface
0021 E0                MOVX    A,@DPTR
0022 FF                MOV     R7,A
0023 7400        R     MOV     A,#LOW USBFS_hidIdleTimer
0025 2F                ADD     A,R7
0026 F582              MOV     DPL,A
0028 E4                CLR     A
0029 3400        R     ADDC    A,#HIGH USBFS_hidIdleTimer
002B F583              MOV     DPH,A
002D E0                MOVX    A,@DPTR
002E FF                MOV     R7,A
002F EF                MOV     A,R7
0030 D3                SETB    C
0031 9400              SUBB    A,#00H
0033 401A              JC      ?C0002
                                           ; SOURCE LINE # 71
                                           ; SOURCE LINE # 72
0035 900000      R     MOV     DPTR,#interface
0038 E0                MOVX    A,@DPTR
0039 FF                MOV     R7,A
003A 7400        R     MOV     A,#LOW USBFS_hidIdleTimer
003C 2F                ADD     A,R7
003D F582              MOV     DPL,A
003F E4                CLR     A
0040 3400        R     ADDC    A,#HIGH USBFS_hidIdleTimer
0042 F583              MOV     DPH,A
0044 E0                MOVX    A,@DPTR
0045 14                DEC     A
0046 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 73
0047 900000      R     MOV     DPTR,#stat
004A 7402              MOV     A,#02H
004C F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 10  

                                           ; SOURCE LINE # 74
004D 8028              SJMP    ?C0001
004F         ?C0002:
                                           ; SOURCE LINE # 76
                                           ; SOURCE LINE # 77
004F 900000      R     MOV     DPTR,#interface
0052 E0                MOVX    A,@DPTR
0053 FF                MOV     R7,A
0054 7400        R     MOV     A,#LOW USBFS_hidIdleRate
0056 2F                ADD     A,R7
0057 F582              MOV     DPL,A
0059 E4                CLR     A
005A 3400        R     ADDC    A,#HIGH USBFS_hidIdleRate
005C F583              MOV     DPH,A
005E E0                MOVX    A,@DPTR
005F FF                MOV     R7,A
0060 900000      R     MOV     DPTR,#interface
0063 E0                MOVX    A,@DPTR
0064 FE                MOV     R6,A
0065 7400        R     MOV     A,#LOW USBFS_hidIdleTimer
0067 2E                ADD     A,R6
0068 F582              MOV     DPL,A
006A E4                CLR     A
006B 3400        R     ADDC    A,#HIGH USBFS_hidIdleTimer
006D F583              MOV     DPH,A
006F EF                MOV     A,R7
0070 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 78
0071 900000      R     MOV     DPTR,#stat
0074 7401              MOV     A,#01H
0076 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 79
                                           ; SOURCE LINE # 80
0077         ?C0001:
                                           ; SOURCE LINE # 82
0077 900000      R     MOV     DPTR,#stat
007A E0                MOVX    A,@DPTR
007B FF                MOV     R7,A
                                           ; SOURCE LINE # 83
007C         ?C0004:
007C 22                RET     
             ; FUNCTION _USBFS_UpdateHIDTimer (END)

             ; FUNCTION _USBFS_GetProtocol (BEGIN)
                                           ; SOURCE LINE # 100
0000 900000      R     MOV     DPTR,#interface
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 101
                                           ; SOURCE LINE # 102
0005 900000      R     MOV     DPTR,#interface
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A 7400        R     MOV     A,#LOW USBFS_hidProtocol
000C 2F                ADD     A,R7
000D F582              MOV     DPL,A
000F E4                CLR     A
0010 3400        R     ADDC    A,#HIGH USBFS_hidProtocol
0012 F583              MOV     DPH,A
0014 E0                MOVX    A,@DPTR
0015 FF                MOV     R7,A
                                           ; SOURCE LINE # 103
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 11  

0016         ?C0005:
0016 22                RET     
             ; FUNCTION _USBFS_GetProtocol (END)

             ; FUNCTION USBFS_DispatchHIDClassRqst (BEGIN)
                                           ; SOURCE LINE # 123
                                           ; SOURCE LINE # 124
                                           ; SOURCE LINE # 125
0000 900000      R     MOV     DPTR,#requestHandled
0003 E4                CLR     A
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 128
0005 906004            MOV     DPTR,#06004H
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A 900000      R     MOV     DPTR,#interfaceNumber
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 129
000F 906000            MOV     DPTR,#06000H
0012 E0                MOVX    A,@DPTR
0013 FF                MOV     R7,A
0014 EF                MOV     A,R7
0015 5480              ANL     A,#080H
0017 FF                MOV     R7,A
0018 7E00              MOV     R6,#00H
001A EF                MOV     A,R7
001B 6480              XRL     A,#080H
001D 4E                ORL     A,R6
001E 6003              JZ      $ + 5H
0020 020000      R     LJMP    ?C0006
                                           ; SOURCE LINE # 130
                                           ; SOURCE LINE # 131
0023 906001            MOV     DPTR,#06001H
0026 E0                MOVX    A,@DPTR
0027 FF                MOV     R7,A
0028 EF                MOV     A,R7
0029 120000      E     LCALL   ?C?CCASE
002C 0000        R     DW      ?C0015
002E 01                DB      01H
002F 0000        R     DW      ?C0017
0031 02                DB      02H
0032 0000        R     DW      ?C0019
0034 03                DB      03H
0035 0000        R     DW      ?C0008
0037 06                DB      06H
0038 0000              DW      00H
003A 0000        R     DW      ?C0022
                                           ; SOURCE LINE # 132
                                           ; SOURCE LINE # 133
003C         ?C0008:
                                           ; SOURCE LINE # 134
003C 906003            MOV     DPTR,#06003H
003F E0                MOVX    A,@DPTR
0040 FF                MOV     R7,A
0041 EF                MOV     A,R7
0042 B4211D            CJNE    A,#021H,?C0009
                                           ; SOURCE LINE # 135
                                           ; SOURCE LINE # 136
0045 120000      R     LCALL   USBFS_FindHidClassDecriptor
                                           ; SOURCE LINE # 137
0048 900000      E     MOV     DPTR,#USBFS_currentTD
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 12  

004B E0                MOVX    A,@DPTR
004C FE                MOV     R6,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F FF                MOV     R7,A
0050 EF                MOV     A,R7
0051 4E                ORL     A,R6
0052 7003              JNZ     $ + 5H
0054 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 138
                                           ; SOURCE LINE # 139
0057 120000      E     LCALL   USBFS_InitControlRead
005A 900000      R     MOV     DPTR,#requestHandled
005D EF                MOV     A,R7
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 140
                                           ; SOURCE LINE # 141
005F 020000      R     LJMP    ?C0022
0062         ?C0009:
                                           ; SOURCE LINE # 142
0062 906003            MOV     DPTR,#06003H
0065 E0                MOVX    A,@DPTR
0066 FF                MOV     R7,A
0067 EF                MOV     A,R7
0068 6422              XRL     A,#022H
006A 6003              JZ      $ + 5H
006C 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 143
                                           ; SOURCE LINE # 144
006F 120000      R     LCALL   USBFS_FindReportDescriptor
                                           ; SOURCE LINE # 145
0072 900000      E     MOV     DPTR,#USBFS_currentTD
0075 E0                MOVX    A,@DPTR
0076 FE                MOV     R6,A
0077 A3                INC     DPTR
0078 E0                MOVX    A,@DPTR
0079 FF                MOV     R7,A
007A EF                MOV     A,R7
007B 4E                ORL     A,R6
007C 7003              JNZ     $ + 5H
007E 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 146
                                           ; SOURCE LINE # 147
0081 120000      E     LCALL   USBFS_InitControlRead
0084 900000      R     MOV     DPTR,#requestHandled
0087 EF                MOV     A,R7
0088 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 148
                                           ; SOURCE LINE # 149
0089 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 151
                                           ; SOURCE LINE # 152
                                           ; SOURCE LINE # 153
                                           ; SOURCE LINE # 154
008C         ?C0015:
                                           ; SOURCE LINE # 155
008C 120000      R     LCALL   USBFS_FindReport
                                           ; SOURCE LINE # 156
008F 900000      E     MOV     DPTR,#USBFS_currentTD
0092 E0                MOVX    A,@DPTR
0093 FE                MOV     R6,A
0094 A3                INC     DPTR
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 13  

0095 E0                MOVX    A,@DPTR
0096 FF                MOV     R7,A
0097 EF                MOV     A,R7
0098 4E                ORL     A,R6
0099 7003              JNZ     $ + 5H
009B 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 157
                                           ; SOURCE LINE # 158
009E 120000      E     LCALL   USBFS_InitControlRead
00A1 900000      R     MOV     DPTR,#requestHandled
00A4 EF                MOV     A,R7
00A5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 159
                                           ; SOURCE LINE # 160
00A6 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 162
00A9         ?C0017:
                                           ; SOURCE LINE # 166
00A9 900000      R     MOV     DPTR,#interfaceNumber
00AC E0                MOVX    A,@DPTR
00AD FF                MOV     R7,A
00AE EF                MOV     A,R7
00AF C3                CLR     C
00B0 9401              SUBB    A,#01H
00B2 4003              JC      $ + 5H
00B4 020000      R     LJMP    ?C0022
00B7 906002            MOV     DPTR,#06002H
00BA E0                MOVX    A,@DPTR
00BB FF                MOV     R7,A
00BC EF                MOV     A,R7
00BD 6003              JZ      $ + 5H
00BF 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 167
                                           ; SOURCE LINE # 168
00C2 900000      E     MOV     DPTR,#USBFS_currentTD
00C5 E4                CLR     A
00C6 F0                MOVX    @DPTR,A
00C7 A3                INC     DPTR
00C8 7401              MOV     A,#01H
00CA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 169
00CB 900000      R     MOV     DPTR,#interfaceNumber
00CE E0                MOVX    A,@DPTR
00CF FF                MOV     R7,A
00D0 7400        R     MOV     A,#LOW USBFS_hidIdleRate
00D2 2F                ADD     A,R7
00D3 F9                MOV     R1,A
00D4 E4                CLR     A
00D5 3400        R     ADDC    A,#HIGH USBFS_hidIdleRate
00D7 FA                MOV     R2,A
00D8 7B01              MOV     R3,#01H
00DA 900000      E     MOV     DPTR,#USBFS_currentTD+02H
00DD 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 170
00E0 120000      E     LCALL   USBFS_InitControlRead
00E3 900000      R     MOV     DPTR,#requestHandled
00E6 EF                MOV     A,R7
00E7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 171
                                           ; SOURCE LINE # 172
00E8 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 173
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 14  

00EB         ?C0019:
                                           ; SOURCE LINE # 175
00EB 900000      R     MOV     DPTR,#interfaceNumber
00EE E0                MOVX    A,@DPTR
00EF FF                MOV     R7,A
00F0 EF                MOV     A,R7
00F1 C3                CLR     C
00F2 9401              SUBB    A,#01H
00F4 4003              JC      $ + 5H
00F6 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 176
                                           ; SOURCE LINE # 177
00F9 900000      E     MOV     DPTR,#USBFS_currentTD
00FC E4                CLR     A
00FD F0                MOVX    @DPTR,A
00FE A3                INC     DPTR
00FF 7401              MOV     A,#01H
0101 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 178
0102 900000      R     MOV     DPTR,#interfaceNumber
0105 E0                MOVX    A,@DPTR
0106 FF                MOV     R7,A
0107 7400        R     MOV     A,#LOW USBFS_hidProtocol
0109 2F                ADD     A,R7
010A F9                MOV     R1,A
010B E4                CLR     A
010C 3400        R     ADDC    A,#HIGH USBFS_hidProtocol
010E FA                MOV     R2,A
010F 7B01              MOV     R3,#01H
0111 900000      E     MOV     DPTR,#USBFS_currentTD+02H
0114 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 179
0117 120000      E     LCALL   USBFS_InitControlRead
011A 900000      R     MOV     DPTR,#requestHandled
011D EF                MOV     A,R7
011E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 180
                                           ; SOURCE LINE # 181
011F 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 182
                                           ; SOURCE LINE # 183
                                           ; SOURCE LINE # 184
                                           ; SOURCE LINE # 185
0122 020000      R     LJMP    ?C0022
0125         ?C0006:
                                           ; SOURCE LINE # 186
0125 906000            MOV     DPTR,#06000H
0128 E0                MOVX    A,@DPTR
0129 FF                MOV     R7,A
012A EF                MOV     A,R7
012B 5480              ANL     A,#080H
012D FF                MOV     R7,A
012E 7E00              MOV     R6,#00H
0130 EF                MOV     A,R7
0131 4E                ORL     A,R6
0132 6003              JZ      $ + 5H
0134 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 188
                                           ; SOURCE LINE # 189
0137 906001            MOV     DPTR,#06001H
013A E0                MOVX    A,@DPTR
013B FF                MOV     R7,A
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 15  

013C EF                MOV     A,R7
013D 120000      E     LCALL   ?C?CCASE
0140 0000        R     DW      ?C0025
0142 09                DB      09H
0143 0000        R     DW      ?C0027
0145 0A                DB      0AH
0146 0000        R     DW      ?C0033
0148 0B                DB      0BH
0149 0000              DW      00H
014B 0000        R     DW      ?C0022
                                           ; SOURCE LINE # 190
                                           ; SOURCE LINE # 191
014D         ?C0025:
                                           ; SOURCE LINE # 192
014D 120000      R     LCALL   USBFS_FindReport
                                           ; SOURCE LINE # 193
0150 900000      E     MOV     DPTR,#USBFS_currentTD
0153 E0                MOVX    A,@DPTR
0154 FE                MOV     R6,A
0155 A3                INC     DPTR
0156 E0                MOVX    A,@DPTR
0157 FF                MOV     R7,A
0158 EF                MOV     A,R7
0159 4E                ORL     A,R6
015A 7003              JNZ     $ + 5H
015C 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 194
                                           ; SOURCE LINE # 195
015F 120000      E     LCALL   USBFS_InitControlWrite
0162 900000      R     MOV     DPTR,#requestHandled
0165 EF                MOV     A,R7
0166 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 196
                                           ; SOURCE LINE # 197
0167 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 198
016A         ?C0027:
                                           ; SOURCE LINE # 202
016A 900000      R     MOV     DPTR,#interfaceNumber
016D E0                MOVX    A,@DPTR
016E FF                MOV     R7,A
016F EF                MOV     A,R7
0170 C3                CLR     C
0171 9401              SUBB    A,#01H
0173 4003              JC      $ + 5H
0175 020000      R     LJMP    ?C0022
0178 906002            MOV     DPTR,#06002H
017B E0                MOVX    A,@DPTR
017C FF                MOV     R7,A
017D EF                MOV     A,R7
017E 6003              JZ      $ + 5H
0180 020000      R     LJMP    ?C0022
                                           ; SOURCE LINE # 203
                                           ; SOURCE LINE # 204
0183 906003            MOV     DPTR,#06003H
0186 E0                MOVX    A,@DPTR
0187 FF                MOV     R7,A
0188 900000      R     MOV     DPTR,#interfaceNumber
018B E0                MOVX    A,@DPTR
018C FE                MOV     R6,A
018D 7400        R     MOV     A,#LOW USBFS_hidIdleRate
018F 2E                ADD     A,R6
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 16  

0190 F582              MOV     DPL,A
0192 E4                CLR     A
0193 3400        R     ADDC    A,#HIGH USBFS_hidIdleRate
0195 F583              MOV     DPH,A
0197 EF                MOV     A,R7
0198 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 210
0199 900000      R     MOV     DPTR,#interfaceNumber
019C E0                MOVX    A,@DPTR
019D FF                MOV     R7,A
019E 7400        R     MOV     A,#LOW USBFS_hidIdleTimer
01A0 2F                ADD     A,R7
01A1 F582              MOV     DPL,A
01A3 E4                CLR     A
01A4 3400        R     ADDC    A,#HIGH USBFS_hidIdleTimer
01A6 F583              MOV     DPH,A
01A8 E0                MOVX    A,@DPTR
01A9 FF                MOV     R7,A
01AA 900000      R     MOV     DPTR,#interfaceNumber
01AD E0                MOVX    A,@DPTR
01AE FE                MOV     R6,A
01AF 7400        R     MOV     A,#LOW USBFS_hidIdleRate
01B1 2E                ADD     A,R6
01B2 F582              MOV     DPL,A
01B4 E4                CLR     A
01B5 3400        R     ADDC    A,#HIGH USBFS_hidIdleRate
01B7 F583              MOV     DPH,A
01B9 E0                MOVX    A,@DPTR
01BA FE                MOV     R6,A
01BB EE                MOV     A,R6
01BC C3                CLR     C
01BD 9F                SUBB    A,R7
01BE 5013              JNC     ?C0029
                                           ; SOURCE LINE # 212
                                           ; SOURCE LINE # 214
01C0 900000      R     MOV     DPTR,#interfaceNumber
01C3 E0                MOVX    A,@DPTR
01C4 FF                MOV     R7,A
01C5 7400        R     MOV     A,#LOW USBFS_hidIdleTimer
01C7 2F                ADD     A,R7
01C8 F582              MOV     DPL,A
01CA E4                CLR     A
01CB 3400        R     ADDC    A,#HIGH USBFS_hidIdleTimer
01CD F583              MOV     DPH,A
01CF E4                CLR     A
01D0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 215
01D1 8039              SJMP    ?C0030
01D3         ?C0029:
                                           ; SOURCE LINE # 220
01D3 900000      R     MOV     DPTR,#interfaceNumber
01D6 E0                MOVX    A,@DPTR
01D7 FF                MOV     R7,A
01D8 7400        R     MOV     A,#LOW USBFS_hidIdleTimer
01DA 2F                ADD     A,R7
01DB F582              MOV     DPL,A
01DD E4                CLR     A
01DE 3400        R     ADDC    A,#HIGH USBFS_hidIdleTimer
01E0 F583              MOV     DPH,A
01E2 E0                MOVX    A,@DPTR
01E3 FF                MOV     R7,A
01E4 EF                MOV     A,R7
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 17  

01E5 D3                SETB    C
01E6 9401              SUBB    A,#01H
01E8 4022              JC      ?C0030
                                           ; SOURCE LINE # 221
                                           ; SOURCE LINE # 226
01EA         ?C0031:
                                           ; SOURCE LINE # 228
                                           ; SOURCE LINE # 229
01EA 900000      R     MOV     DPTR,#interfaceNumber
01ED E0                MOVX    A,@DPTR
01EE FF                MOV     R7,A
01EF 7400        R     MOV     A,#LOW USBFS_hidIdleRate
01F1 2F                ADD     A,R7
01F2 F582              MOV     DPL,A
01F4 E4                CLR     A
01F5 3400        R     ADDC    A,#HIGH USBFS_hidIdleRate
01F7 F583              MOV     DPH,A
01F9 E0                MOVX    A,@DPTR
01FA FF                MOV     R7,A
01FB 900000      R     MOV     DPTR,#interfaceNumber
01FE E0                MOVX    A,@DPTR
01FF FE                MOV     R6,A
0200 7400        R     MOV     A,#LOW USBFS_hidIdleTimer
0202 2E                ADD     A,R6
0203 F582              MOV     DPL,A
0205 E4                CLR     A
0206 3400        R     ADDC    A,#HIGH USBFS_hidIdleTimer
0208 F583              MOV     DPH,A
020A EF                MOV     A,R7
020B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 231
020C         ?C0030:
                                           ; SOURCE LINE # 232
020C 120000      E     LCALL   USBFS_InitNoDataControlTransfer
020F 900000      R     MOV     DPTR,#requestHandled
0212 EF                MOV     A,R7
0213 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 233
                                           ; SOURCE LINE # 234
0214 8034              SJMP    ?C0022
                                           ; SOURCE LINE # 236
0216         ?C0033:
                                           ; SOURCE LINE # 239
0216 900000      R     MOV     DPTR,#interfaceNumber
0219 E0                MOVX    A,@DPTR
021A FF                MOV     R7,A
021B EF                MOV     A,R7
021C C3                CLR     C
021D 9401              SUBB    A,#01H
021F 5029              JNC     ?C0022
0221 906002            MOV     DPTR,#06002H
0224 E0                MOVX    A,@DPTR
0225 FF                MOV     R7,A
0226 EF                MOV     A,R7
0227 D3                SETB    C
0228 9401              SUBB    A,#01H
022A 501E              JNC     ?C0022
                                           ; SOURCE LINE # 240
                                           ; SOURCE LINE # 241
022C 906002            MOV     DPTR,#06002H
022F E0                MOVX    A,@DPTR
0230 FF                MOV     R7,A
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 18  

0231 900000      R     MOV     DPTR,#interfaceNumber
0234 E0                MOVX    A,@DPTR
0235 FE                MOV     R6,A
0236 7400        R     MOV     A,#LOW USBFS_hidProtocol
0238 2E                ADD     A,R6
0239 F582              MOV     DPL,A
023B E4                CLR     A
023C 3400        R     ADDC    A,#HIGH USBFS_hidProtocol
023E F583              MOV     DPH,A
0240 EF                MOV     A,R7
0241 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 242
0242 120000      E     LCALL   USBFS_InitNoDataControlTransfer
0245 900000      R     MOV     DPTR,#requestHandled
0248 EF                MOV     A,R7
0249 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 243
                                           ; SOURCE LINE # 244
                                           ; SOURCE LINE # 245
                                           ; SOURCE LINE # 246
                                           ; SOURCE LINE # 247
                                           ; SOURCE LINE # 248
                                           ; SOURCE LINE # 250
                                           ; SOURCE LINE # 251
024A         ?C0022:
                                           ; SOURCE LINE # 253
024A 900000      R     MOV     DPTR,#requestHandled
024D E0                MOVX    A,@DPTR
024E FF                MOV     R7,A
                                           ; SOURCE LINE # 254
024F         ?C0037:
024F 22                RET     
             ; FUNCTION USBFS_DispatchHIDClassRqst (END)

             ; FUNCTION USBFS_FindHidClassDecriptor (BEGIN)
                                           ; SOURCE LINE # 277
                                           ; SOURCE LINE # 278
                                           ; SOURCE LINE # 283
0000 900000      E     MOV     DPTR,#USBFS_configuration
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 14                DEC     A
0007 FF                MOV     R7,A
0008 120000      E     LCALL   _USBFS_GetConfigTablePtr
000B 900000      R     MOV     DPTR,#pTmp
000E EE                MOV     A,R6
000F F0                MOVX    @DPTR,A
0010 A3                INC     DPTR
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 284
0013 906004            MOV     DPTR,#06004H
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 900000      R     MOV     DPTR,#interfaceN
001B EF                MOV     A,R7
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 287
001D 900000      R     MOV     DPTR,#interfaceN
0020 E0                MOVX    A,@DPTR
0021 FF                MOV     R7,A
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 19  

0022 7E00              MOV     R6,#00H
0024 EF                MOV     A,R7
0025 2402              ADD     A,#02H
0027 FF                MOV     R7,A
0028 EE                MOV     A,R6
0029 3400              ADDC    A,#00H
002B FE                MOV     R6,A
002C EF                MOV     A,R7
002D 7802              MOV     R0,#02H
002F         ?C0044:
002F C3                CLR     C
0030 33                RLC     A
0031 CE                XCH     A,R6
0032 33                RLC     A
0033 CE                XCH     A,R6
0034 D8F9              DJNZ    R0,?C0044
0036 FF                MOV     R7,A
0037 900000      R     MOV     DPTR,#pTmp
003A E0                MOVX    A,@DPTR
003B FC                MOV     R4,A
003C A3                INC     DPTR
003D E0                MOVX    A,@DPTR
003E FD                MOV     R5,A
003F EF                MOV     A,R7
0040 2D                ADD     A,R5
0041 FF                MOV     R7,A
0042 EE                MOV     A,R6
0043 3C                ADDC    A,R4
0044 FE                MOV     R6,A
0045 900000      R     MOV     DPTR,#pTmp
0048 EE                MOV     A,R6
0049 F0                MOVX    @DPTR,A
004A A3                INC     DPTR
004B EF                MOV     A,R7
004C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 289
004D 900000      R     MOV     DPTR,#pTmp
0050 E0                MOVX    A,@DPTR
0051 FE                MOV     R6,A
0052 A3                INC     DPTR
0053 E0                MOVX    A,@DPTR
0054 FF                MOV     R7,A
0055 8F82              MOV     DPL,R7
0057 8E83              MOV     DPH,R6
0059 A3                INC     DPTR
005A 120000      E     LCALL   ?C?PLDCODE
005D AE02              MOV     R6,AR2
005F AF01              MOV     R7,AR1
0061 900000      R     MOV     DPTR,#pTmp
0064 EE                MOV     A,R6
0065 F0                MOVX    @DPTR,A
0066 A3                INC     DPTR
0067 EF                MOV     A,R7
0068 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 291
0069 900000      R     MOV     DPTR,#interfaceN
006C E0                MOVX    A,@DPTR
006D FF                MOV     R7,A
006E 7400        E     MOV     A,#LOW USBFS_interfaceSetting
0070 2F                ADD     A,R7
0071 F582              MOV     DPL,A
0073 E4                CLR     A
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 20  

0074 3400        E     ADDC    A,#HIGH USBFS_interfaceSetting
0076 F583              MOV     DPH,A
0078 E0                MOVX    A,@DPTR
0079 FF                MOV     R7,A
007A 7E04              MOV     R6,#04H
007C EF                MOV     A,R7
007D 8EF0              MOV     B,R6
007F A4                MUL     AB
0080 FF                MOV     R7,A
0081 AEF0              MOV     R6,B
0083 900000      R     MOV     DPTR,#pTmp
0086 E0                MOVX    A,@DPTR
0087 FC                MOV     R4,A
0088 A3                INC     DPTR
0089 E0                MOVX    A,@DPTR
008A FD                MOV     R5,A
008B EF                MOV     A,R7
008C 2D                ADD     A,R5
008D FF                MOV     R7,A
008E EE                MOV     A,R6
008F 3C                ADDC    A,R4
0090 FE                MOV     R6,A
0091 900000      R     MOV     DPTR,#pTmp
0094 EE                MOV     A,R6
0095 F0                MOVX    @DPTR,A
0096 A3                INC     DPTR
0097 EF                MOV     A,R7
0098 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 293
0099 900000      R     MOV     DPTR,#pTmp
009C E0                MOVX    A,@DPTR
009D FE                MOV     R6,A
009E A3                INC     DPTR
009F E0                MOVX    A,@DPTR
00A0 FF                MOV     R7,A
00A1 8F82              MOV     DPL,R7
00A3 8E83              MOV     DPH,R6
00A5 A3                INC     DPTR
00A6 120000      E     LCALL   ?C?PLDCODE
00A9 AE02              MOV     R6,AR2
00AB AF01              MOV     R7,AR1
00AD 900000      R     MOV     DPTR,#pTmp
00B0 EE                MOV     A,R6
00B1 F0                MOVX    @DPTR,A
00B2 A3                INC     DPTR
00B3 EF                MOV     A,R7
00B4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 295
00B5 900000      R     MOV     DPTR,#pTmp
00B8 E0                MOVX    A,@DPTR
00B9 FE                MOV     R6,A
00BA A3                INC     DPTR
00BB E0                MOVX    A,@DPTR
00BC FF                MOV     R7,A
00BD EF                MOV     A,R7
00BE 2410              ADD     A,#010H
00C0 FF                MOV     R7,A
00C1 EE                MOV     A,R6
00C2 3400              ADDC    A,#00H
00C4 FE                MOV     R6,A
00C5 900000      R     MOV     DPTR,#pTmp
00C8 EE                MOV     A,R6
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 21  

00C9 F0                MOVX    @DPTR,A
00CA A3                INC     DPTR
00CB EF                MOV     A,R7
00CC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 296
00CD 900000      R     MOV     DPTR,#pTmp
00D0 E0                MOVX    A,@DPTR
00D1 FE                MOV     R6,A
00D2 A3                INC     DPTR
00D3 E0                MOVX    A,@DPTR
00D4 FF                MOV     R7,A
00D5 8F82              MOV     DPL,R7
00D7 8E83              MOV     DPH,R6
00D9 A3                INC     DPTR
00DA 120000      E     LCALL   ?C?PLDCODE
00DD 900000      R     MOV     DPTR,#pDescr
00E0 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 298
00E3 900000      R     MOV     DPTR,#pDescr
00E6 120000      E     LCALL   ?C?PLDXDATA
00E9 120000      E     LCALL   ?C?CLDPTR
00EC FF                MOV     R7,A
00ED 7E00              MOV     R6,#00H
00EF 900000      E     MOV     DPTR,#USBFS_currentTD
00F2 EE                MOV     A,R6
00F3 F0                MOVX    @DPTR,A
00F4 A3                INC     DPTR
00F5 EF                MOV     A,R7
00F6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 299
00F7 900000      R     MOV     DPTR,#pDescr
00FA 120000      E     LCALL   ?C?PLDXDATA
00FD 900000      E     MOV     DPTR,#USBFS_currentTD+02H
0100 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 300
0103 22                RET     
             ; FUNCTION USBFS_FindHidClassDecriptor (END)

             ; FUNCTION USBFS_FindReportDescriptor (BEGIN)
                                           ; SOURCE LINE # 323
                                           ; SOURCE LINE # 324
                                           ; SOURCE LINE # 329
0000 900000      E     MOV     DPTR,#USBFS_configuration
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 14                DEC     A
0007 FF                MOV     R7,A
0008 120000      E     LCALL   _USBFS_GetConfigTablePtr
000B 900000      R     MOV     DPTR,#pTmp
000E EE                MOV     A,R6
000F F0                MOVX    @DPTR,A
0010 A3                INC     DPTR
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 330
0013 906004            MOV     DPTR,#06004H
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 900000      R     MOV     DPTR,#interfaceN
001B EF                MOV     A,R7
001C F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 22  

                                           ; SOURCE LINE # 333
001D 900000      R     MOV     DPTR,#interfaceN
0020 E0                MOVX    A,@DPTR
0021 FF                MOV     R7,A
0022 7E00              MOV     R6,#00H
0024 EF                MOV     A,R7
0025 2402              ADD     A,#02H
0027 FF                MOV     R7,A
0028 EE                MOV     A,R6
0029 3400              ADDC    A,#00H
002B FE                MOV     R6,A
002C EF                MOV     A,R7
002D 7802              MOV     R0,#02H
002F         ?C0045:
002F C3                CLR     C
0030 33                RLC     A
0031 CE                XCH     A,R6
0032 33                RLC     A
0033 CE                XCH     A,R6
0034 D8F9              DJNZ    R0,?C0045
0036 FF                MOV     R7,A
0037 900000      R     MOV     DPTR,#pTmp
003A E0                MOVX    A,@DPTR
003B FC                MOV     R4,A
003C A3                INC     DPTR
003D E0                MOVX    A,@DPTR
003E FD                MOV     R5,A
003F EF                MOV     A,R7
0040 2D                ADD     A,R5
0041 FF                MOV     R7,A
0042 EE                MOV     A,R6
0043 3C                ADDC    A,R4
0044 FE                MOV     R6,A
0045 900000      R     MOV     DPTR,#pTmp
0048 EE                MOV     A,R6
0049 F0                MOVX    @DPTR,A
004A A3                INC     DPTR
004B EF                MOV     A,R7
004C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 335
004D 900000      R     MOV     DPTR,#pTmp
0050 E0                MOVX    A,@DPTR
0051 FE                MOV     R6,A
0052 A3                INC     DPTR
0053 E0                MOVX    A,@DPTR
0054 FF                MOV     R7,A
0055 8F82              MOV     DPL,R7
0057 8E83              MOV     DPH,R6
0059 A3                INC     DPTR
005A 120000      E     LCALL   ?C?PLDCODE
005D AE02              MOV     R6,AR2
005F AF01              MOV     R7,AR1
0061 900000      R     MOV     DPTR,#pTmp
0064 EE                MOV     A,R6
0065 F0                MOVX    @DPTR,A
0066 A3                INC     DPTR
0067 EF                MOV     A,R7
0068 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 337
0069 900000      R     MOV     DPTR,#interfaceN
006C E0                MOVX    A,@DPTR
006D FF                MOV     R7,A
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 23  

006E 7400        E     MOV     A,#LOW USBFS_interfaceSetting
0070 2F                ADD     A,R7
0071 F582              MOV     DPL,A
0073 E4                CLR     A
0074 3400        E     ADDC    A,#HIGH USBFS_interfaceSetting
0076 F583              MOV     DPH,A
0078 E0                MOVX    A,@DPTR
0079 FF                MOV     R7,A
007A 7E04              MOV     R6,#04H
007C EF                MOV     A,R7
007D 8EF0              MOV     B,R6
007F A4                MUL     AB
0080 FF                MOV     R7,A
0081 AEF0              MOV     R6,B
0083 900000      R     MOV     DPTR,#pTmp
0086 E0                MOVX    A,@DPTR
0087 FC                MOV     R4,A
0088 A3                INC     DPTR
0089 E0                MOVX    A,@DPTR
008A FD                MOV     R5,A
008B EF                MOV     A,R7
008C 2D                ADD     A,R5
008D FF                MOV     R7,A
008E EE                MOV     A,R6
008F 3C                ADDC    A,R4
0090 FE                MOV     R6,A
0091 900000      R     MOV     DPTR,#pTmp
0094 EE                MOV     A,R6
0095 F0                MOVX    @DPTR,A
0096 A3                INC     DPTR
0097 EF                MOV     A,R7
0098 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 339
0099 900000      R     MOV     DPTR,#pTmp
009C E0                MOVX    A,@DPTR
009D FE                MOV     R6,A
009E A3                INC     DPTR
009F E0                MOVX    A,@DPTR
00A0 FF                MOV     R7,A
00A1 8F82              MOV     DPL,R7
00A3 8E83              MOV     DPH,R6
00A5 A3                INC     DPTR
00A6 120000      E     LCALL   ?C?PLDCODE
00A9 AE02              MOV     R6,AR2
00AB AF01              MOV     R7,AR1
00AD 900000      R     MOV     DPTR,#pTmp
00B0 EE                MOV     A,R6
00B1 F0                MOVX    @DPTR,A
00B2 A3                INC     DPTR
00B3 EF                MOV     A,R7
00B4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 341
00B5 900000      R     MOV     DPTR,#pTmp
00B8 E0                MOVX    A,@DPTR
00B9 FE                MOV     R6,A
00BA A3                INC     DPTR
00BB E0                MOVX    A,@DPTR
00BC FF                MOV     R7,A
00BD EF                MOV     A,R7
00BE 240C              ADD     A,#0CH
00C0 FF                MOV     R7,A
00C1 EE                MOV     A,R6
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 24  

00C2 3400              ADDC    A,#00H
00C4 FE                MOV     R6,A
00C5 900000      R     MOV     DPTR,#pTmp
00C8 EE                MOV     A,R6
00C9 F0                MOVX    @DPTR,A
00CA A3                INC     DPTR
00CB EF                MOV     A,R7
00CC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 342
00CD 900000      R     MOV     DPTR,#pTmp
00D0 E0                MOVX    A,@DPTR
00D1 FE                MOV     R6,A
00D2 A3                INC     DPTR
00D3 E0                MOVX    A,@DPTR
00D4 FF                MOV     R7,A
00D5 8F82              MOV     DPL,R7
00D7 8E83              MOV     DPH,R6
00D9 A3                INC     DPTR
00DA 120000      E     LCALL   ?C?PLDCODE
00DD 900000      R     MOV     DPTR,#pDescr
00E0 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 344
00E3 900000      R     MOV     DPTR,#pDescr
00E6 120000      E     LCALL   ?C?PLDXDATA
00E9 E9                MOV     A,R1
00EA 2401              ADD     A,#01H
00EC F9                MOV     R1,A
00ED EA                MOV     A,R2
00EE 3400              ADDC    A,#00H
00F0 FA                MOV     R2,A
00F1 120000      E     LCALL   ?C?CLDPTR
00F4 FF                MOV     R7,A
00F5 7E00              MOV     R6,#00H
00F7 EF                MOV     A,R7
00F8 7F00              MOV     R7,#00H
00FA FE                MOV     R6,A
00FB 900000      R     MOV     DPTR,#pDescr
00FE 120000      E     LCALL   ?C?PLDXDATA
0101 120000      E     LCALL   ?C?CLDPTR
0104 FD                MOV     R5,A
0105 7C00              MOV     R4,#00H
0107 EE                MOV     A,R6
0108 4C                ORL     A,R4
0109 FE                MOV     R6,A
010A EF                MOV     A,R7
010B 4D                ORL     A,R5
010C FF                MOV     R7,A
010D 900000      E     MOV     DPTR,#USBFS_currentTD
0110 EE                MOV     A,R6
0111 F0                MOVX    @DPTR,A
0112 A3                INC     DPTR
0113 EF                MOV     A,R7
0114 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 345
0115 900000      R     MOV     DPTR,#pDescr
0118 120000      E     LCALL   ?C?PLDXDATA
011B E9                MOV     A,R1
011C 2402              ADD     A,#02H
011E F9                MOV     R1,A
011F EA                MOV     A,R2
0120 3400              ADDC    A,#00H
0122 FA                MOV     R2,A
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 25  

0123 900000      E     MOV     DPTR,#USBFS_currentTD+02H
0126 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 346
0129 22                RET     
             ; FUNCTION USBFS_FindReportDescriptor (END)

             ; FUNCTION USBFS_FindReport (BEGIN)
                                           ; SOURCE LINE # 369
                                           ; SOURCE LINE # 370
                                           ; SOURCE LINE # 384
0000 900000      E     MOV     DPTR,#USBFS_currentTD
0003 E4                CLR     A
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 E4                CLR     A
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 385
0008 900000      E     MOV     DPTR,#USBFS_configuration
000B E0                MOVX    A,@DPTR
000C FF                MOV     R7,A
000D EF                MOV     A,R7
000E 14                DEC     A
000F FF                MOV     R7,A
0010 120000      E     LCALL   _USBFS_GetConfigTablePtr
0013 900000      R     MOV     DPTR,#pTmp
0016 EE                MOV     A,R6
0017 F0                MOVX    @DPTR,A
0018 A3                INC     DPTR
0019 EF                MOV     A,R7
001A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 386
001B 906003            MOV     DPTR,#06003H
001E E0                MOVX    A,@DPTR
001F FF                MOV     R7,A
0020 900000      R     MOV     DPTR,#reportType
0023 EF                MOV     A,R7
0024 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 387
0025 906004            MOV     DPTR,#06004H
0028 E0                MOVX    A,@DPTR
0029 FF                MOV     R7,A
002A 900000      R     MOV     DPTR,#interfaceN
002D EF                MOV     A,R7
002E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 390
002F 900000      R     MOV     DPTR,#interfaceN
0032 E0                MOVX    A,@DPTR
0033 FF                MOV     R7,A
0034 7E00              MOV     R6,#00H
0036 EF                MOV     A,R7
0037 2402              ADD     A,#02H
0039 FF                MOV     R7,A
003A EE                MOV     A,R6
003B 3400              ADDC    A,#00H
003D FE                MOV     R6,A
003E EF                MOV     A,R7
003F 7802              MOV     R0,#02H
0041         ?C0046:
0041 C3                CLR     C
0042 33                RLC     A
0043 CE                XCH     A,R6
0044 33                RLC     A
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 26  

0045 CE                XCH     A,R6
0046 D8F9              DJNZ    R0,?C0046
0048 FF                MOV     R7,A
0049 900000      R     MOV     DPTR,#pTmp
004C E0                MOVX    A,@DPTR
004D FC                MOV     R4,A
004E A3                INC     DPTR
004F E0                MOVX    A,@DPTR
0050 FD                MOV     R5,A
0051 EF                MOV     A,R7
0052 2D                ADD     A,R5
0053 FF                MOV     R7,A
0054 EE                MOV     A,R6
0055 3C                ADDC    A,R4
0056 FE                MOV     R6,A
0057 900000      R     MOV     DPTR,#pTmp
005A EE                MOV     A,R6
005B F0                MOVX    @DPTR,A
005C A3                INC     DPTR
005D EF                MOV     A,R7
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 392
005F 900000      R     MOV     DPTR,#pTmp
0062 E0                MOVX    A,@DPTR
0063 FE                MOV     R6,A
0064 A3                INC     DPTR
0065 E0                MOVX    A,@DPTR
0066 FF                MOV     R7,A
0067 8F82              MOV     DPL,R7
0069 8E83              MOV     DPH,R6
006B A3                INC     DPTR
006C 120000      E     LCALL   ?C?PLDCODE
006F AE02              MOV     R6,AR2
0071 AF01              MOV     R7,AR1
0073 900000      R     MOV     DPTR,#pTmp
0076 EE                MOV     A,R6
0077 F0                MOVX    @DPTR,A
0078 A3                INC     DPTR
0079 EF                MOV     A,R7
007A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 393
007B 900000      R     MOV     DPTR,#interfaceN
007E E0                MOVX    A,@DPTR
007F FF                MOV     R7,A
0080 EF                MOV     A,R7
0081 C3                CLR     C
0082 9401              SUBB    A,#01H
0084 4003              JC      $ + 5H
0086 020000      R     LJMP    ?C0043
                                           ; SOURCE LINE # 394
                                           ; SOURCE LINE # 396
0089 900000      R     MOV     DPTR,#interfaceN
008C E0                MOVX    A,@DPTR
008D FF                MOV     R7,A
008E 7400        E     MOV     A,#LOW USBFS_interfaceSetting
0090 2F                ADD     A,R7
0091 F582              MOV     DPL,A
0093 E4                CLR     A
0094 3400        E     ADDC    A,#HIGH USBFS_interfaceSetting
0096 F583              MOV     DPH,A
0098 E0                MOVX    A,@DPTR
0099 FF                MOV     R7,A
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 27  

009A 7E04              MOV     R6,#04H
009C EF                MOV     A,R7
009D 8EF0              MOV     B,R6
009F A4                MUL     AB
00A0 FF                MOV     R7,A
00A1 AEF0              MOV     R6,B
00A3 900000      R     MOV     DPTR,#pTmp
00A6 E0                MOVX    A,@DPTR
00A7 FC                MOV     R4,A
00A8 A3                INC     DPTR
00A9 E0                MOVX    A,@DPTR
00AA FD                MOV     R5,A
00AB EF                MOV     A,R7
00AC 2D                ADD     A,R5
00AD FF                MOV     R7,A
00AE EE                MOV     A,R6
00AF 3C                ADDC    A,R4
00B0 FE                MOV     R6,A
00B1 900000      R     MOV     DPTR,#pTmp
00B4 EE                MOV     A,R6
00B5 F0                MOVX    @DPTR,A
00B6 A3                INC     DPTR
00B7 EF                MOV     A,R7
00B8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 398
00B9 900000      R     MOV     DPTR,#pTmp
00BC E0                MOVX    A,@DPTR
00BD FE                MOV     R6,A
00BE A3                INC     DPTR
00BF E0                MOVX    A,@DPTR
00C0 FF                MOV     R7,A
00C1 8F82              MOV     DPL,R7
00C3 8E83              MOV     DPH,R6
00C5 A3                INC     DPTR
00C6 120000      E     LCALL   ?C?PLDCODE
00C9 AE02              MOV     R6,AR2
00CB AF01              MOV     R7,AR1
00CD 900000      R     MOV     DPTR,#pTmp
00D0 EE                MOV     A,R6
00D1 F0                MOVX    @DPTR,A
00D2 A3                INC     DPTR
00D3 EF                MOV     A,R7
00D4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 400
00D5 900000      R     MOV     DPTR,#reportType
00D8 E0                MOVX    A,@DPTR
00D9 FF                MOV     R7,A
00DA EF                MOV     A,R7
00DB C3                CLR     C
00DC 9401              SUBB    A,#01H
00DE 5003              JNC     $ + 5H
00E0 020000      R     LJMP    ?C0043
00E3 900000      R     MOV     DPTR,#reportType
00E6 E0                MOVX    A,@DPTR
00E7 FF                MOV     R7,A
00E8 EF                MOV     A,R7
00E9 D3                SETB    C
00EA 9403              SUBB    A,#03H
00EC 4003              JC      $ + 5H
00EE 020000      R     LJMP    ?C0043
                                           ; SOURCE LINE # 402
                                           ; SOURCE LINE # 404
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 28  

00F1 900000      R     MOV     DPTR,#reportType
00F4 E0                MOVX    A,@DPTR
00F5 FF                MOV     R7,A
00F6 7E00              MOV     R6,#00H
00F8 EF                MOV     A,R7
00F9 24FF              ADD     A,#0FFH
00FB FF                MOV     R7,A
00FC EE                MOV     A,R6
00FD 34FF              ADDC    A,#0FFH
00FF FE                MOV     R6,A
0100 EF                MOV     A,R7
0101 7802              MOV     R0,#02H
0103         ?C0047:
0103 C3                CLR     C
0104 33                RLC     A
0105 CE                XCH     A,R6
0106 33                RLC     A
0107 CE                XCH     A,R6
0108 D8F9              DJNZ    R0,?C0047
010A FF                MOV     R7,A
010B 900000      R     MOV     DPTR,#pTmp
010E E0                MOVX    A,@DPTR
010F FC                MOV     R4,A
0110 A3                INC     DPTR
0111 E0                MOVX    A,@DPTR
0112 FD                MOV     R5,A
0113 EF                MOV     A,R7
0114 2D                ADD     A,R5
0115 FF                MOV     R7,A
0116 EE                MOV     A,R6
0117 3C                ADDC    A,R4
0118 FE                MOV     R6,A
0119 900000      R     MOV     DPTR,#pTmp
011C EE                MOV     A,R6
011D F0                MOVX    @DPTR,A
011E A3                INC     DPTR
011F EF                MOV     A,R7
0120 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 405
0121 906002            MOV     DPTR,#06002H
0124 E0                MOVX    A,@DPTR
0125 FF                MOV     R7,A
0126 900000      R     MOV     DPTR,#reportType
0129 EF                MOV     A,R7
012A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 407
012B 900000      R     MOV     DPTR,#pTmp
012E E0                MOVX    A,@DPTR
012F FE                MOV     R6,A
0130 A3                INC     DPTR
0131 E0                MOVX    A,@DPTR
0132 FF                MOV     R7,A
0133 8F82              MOV     DPL,R7
0135 8E83              MOV     DPH,R6
0137 E4                CLR     A
0138 93                MOVC    A,@A+DPTR
0139 FF                MOV     R7,A
013A 900000      R     MOV     DPTR,#reportType
013D E0                MOVX    A,@DPTR
013E FE                MOV     R6,A
013F EF                MOV     A,R7
0140 C3                CLR     C
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 29  

0141 9E                SUBB    A,R6
0142 4078              JC      ?C0043
                                           ; SOURCE LINE # 408
                                           ; SOURCE LINE # 409
0144 900000      R     MOV     DPTR,#pTmp
0147 E0                MOVX    A,@DPTR
0148 FE                MOV     R6,A
0149 A3                INC     DPTR
014A E0                MOVX    A,@DPTR
014B FF                MOV     R7,A
014C 8F82              MOV     DPL,R7
014E 8E83              MOV     DPH,R6
0150 A3                INC     DPTR
0151 120000      E     LCALL   ?C?PLDCODE
0154 900000      R     MOV     DPTR,#pTD
0157 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 410
015A 900000      R     MOV     DPTR,#reportType
015D E0                MOVX    A,@DPTR
015E FF                MOV     R7,A
015F 7E08              MOV     R6,#08H
0161 EF                MOV     A,R7
0162 8EF0              MOV     B,R6
0164 A4                MUL     AB
0165 FF                MOV     R7,A
0166 AEF0              MOV     R6,B
0168 900000      R     MOV     DPTR,#pTD
016B 120000      E     LCALL   ?C?PLDXDATA
016E E9                MOV     A,R1
016F 2F                ADD     A,R7
0170 F9                MOV     R1,A
0171 EA                MOV     A,R2
0172 3E                ADDC    A,R6
0173 FA                MOV     R2,A
0174 900000      R     MOV     DPTR,#pTD
0177 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 411
017A 900000      R     MOV     DPTR,#pTD
017D 120000      E     LCALL   ?C?PLDXDATA
0180 E9                MOV     A,R1
0181 2402              ADD     A,#02H
0183 F9                MOV     R1,A
0184 EA                MOV     A,R2
0185 3400              ADDC    A,#00H
0187 FA                MOV     R2,A
0188 120000      E     LCALL   ?C?PLDPTR
018B 900000      E     MOV     DPTR,#USBFS_currentTD+02H
018E 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 412
0191 900000      R     MOV     DPTR,#pTD
0194 120000      E     LCALL   ?C?PLDXDATA
0197 120000      E     LCALL   ?C?ILDPTR
019A FF                MOV     R7,A
019B AEF0              MOV     R6,B
019D 900000      E     MOV     DPTR,#USBFS_currentTD
01A0 EE                MOV     A,R6
01A1 F0                MOVX    @DPTR,A
01A2 A3                INC     DPTR
01A3 EF                MOV     A,R7
01A4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 413
01A5 900000      R     MOV     DPTR,#pTD
C51 COMPILER V9.51   USBFS_HID                                                             10/03/2016 19:53:27 PAGE 30  

01A8 120000      E     LCALL   ?C?PLDXDATA
01AB E9                MOV     A,R1
01AC 2405              ADD     A,#05H
01AE F9                MOV     R1,A
01AF EA                MOV     A,R2
01B0 3400              ADDC    A,#00H
01B2 FA                MOV     R2,A
01B3 120000      E     LCALL   ?C?PLDPTR
01B6 900000      E     MOV     DPTR,#USBFS_currentTD+05H
01B9 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 414
                                           ; SOURCE LINE # 415
                                           ; SOURCE LINE # 416
                                           ; SOURCE LINE # 417
01BC         ?C0043:
01BC 22                RET     
             ; FUNCTION USBFS_FindReport (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1743    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      3      24
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
